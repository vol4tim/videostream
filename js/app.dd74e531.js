(function(){var t={9423:function(t,e,n){"use strict";var o=n(5361),i=n(9242),s=n(3396),a=n(7139);const r=(0,s._)("div",{class:"header"},[(0,s._)("div",{class:"item"},[(0,s._)("h1",null,"Video stream")])],-1),c={class:"block"},l={class:"block"},d=["href"],u={key:0,class:"block"},h={key:1,class:"block"};function f(t,e,n,o,i,f){const p=(0,s.up)("find-video-form"),y=(0,s.up)("ipfs-auth"),g=(0,s.up)("ipfs-files"),w=(0,s.up)("image-content"),m=(0,s.up)("video-content");return(0,s.wg)(),(0,s.iD)(s.HY,null,[r,(0,s._)("div",null,[i.isReady?((0,s.wg)(),(0,s.iD)(s.HY,{key:0},[(0,s._)("div",c,[(0,s.Wm)(p,{onVideo:f.handlerFindVideo},null,8,["onVideo"])]),i.videoCid?((0,s.wg)(),(0,s.iD)(s.HY,{key:0},[(0,s._)("div",l,[(0,s.Uk)(" Result: "),(0,s._)("a",{href:`https://${t.$ipfs_gateway}/ipfs/${i.videoCid}`,target:"_blank"},(0,a.zw)(i.videoCid),9,d)]),i.videoCid?((0,s.wg)(),(0,s.iD)("div",u,[(0,s.Wm)(y,{onAuth:f.handlerAuth},null,8,["onAuth"]),i.ipfsAuth?((0,s.wg)(),(0,s.j4)(g,{key:0,controller:i.videoController,cid:i.videoCid,onPlay:f.handlerPlay},null,8,["controller","cid","onPlay"])):(0,s.kq)("",!0)])):(0,s.kq)("",!0),i.videoContent||i.videoIsLoad?((0,s.wg)(),(0,s.iD)("div",h,["image"===i.typeContent?((0,s.wg)(),(0,s.j4)(w,{key:0,isLoad:i.videoIsLoad,content:i.videoContent},null,8,["isLoad","content"])):((0,s.wg)(),(0,s.j4)(m,{key:1,isLoad:i.videoIsLoad,content:i.videoContent},null,8,["isLoad","content"]))])):(0,s.kq)("",!0)],64)):(0,s.kq)("",!0)],64)):((0,s.wg)(),(0,s.iD)(s.HY,{key:1},[(0,s.Uk)("...")],64))])],64)}const p={style:{"margin-top":"20px"}},y=["disabled"];function g(t,e,n,o,a,r){return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("div",null,[(0,s.Uk)(" Controller "),(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>a.controller=t)},null,512),[[i.nr,a.controller]])]),(0,s._)("div",p,[(0,s._)("button",{onClick:e[1]||(e[1]=(...t)=>r.find&&r.find(...t)),disabled:!r.isValidAddress||a.load},[(0,s.Uk)(" Find twins"),a.load?((0,s.wg)(),(0,s.iD)(s.HY,{key:0},[(0,s.Uk)(" ...")],64)):(0,s.kq)("",!0)],8,y)])],64)}n(7658);var w=n(7665),m=n(3162),v=n(5154),b=n(9361),k=n(2094);const A=t=>{try{return(0,w.m)((0,v.vq)(t)?(0,b.G)(t):(0,m.m)(t)),!0}catch(e){return!1}},$=async(t,e)=>{const n=[],o=await t.twin.getTotal();for(let i=0;i<o;i++){const o=await t.twin.getOwner(i);o===e&&n.push(i)}return n},C=async(t,e)=>{try{const n=await t.twin.getTwin(e);if(n){const t=Object.keys(n).find((t=>"4CC7GkKuJJzFzswqz39m5qWbgXaQks9f36jCgsadpN2c1hnh"===n[t]));if(t)return k.P6.hexToCid(t)}}catch(n){console.log(n)}};var _={emits:["video"],data(){return{controller:"",load:!1}},computed:{isValidAddress(){return A(this.controller)}},methods:{async find(){this.load=!0,this.$emit("video");try{const t=await $(this.$robonomics,this.controller);if(t.length>0){const e=await C(this.$robonomics,t[t.length-1]);this.$emit("video",{controller:this.controller,cid:e})}}catch(t){console.log(t)}this.load=!1}}},L=n(89);const O=(0,L.Z)(_,[["render",g]]);var j=O;const D={key:0},I={key:1,id:"preview",style:{width:"100%"}};function P(t,e,n,o,i,a){return n.isLoad?((0,s.wg)(),(0,s.iD)("div",D,"...")):((0,s.wg)(),(0,s.iD)("img",I))}var V={props:["isLoad","content"],mounted(){this.loadImage(this.content)},watch:{content(){this.loadImage(this.content)}},methods:{async loadImage(t){if(!t)return;const e=new Blob(t,{type:"image/png"}),n=document.getElementById("preview");n.src=URL.createObjectURL(e)}}};const M=(0,L.Z)(V,[["render",P]]);var R=M;function U(t,e,n,o,i,a){const r=(0,s.up)("account");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(r),i.isAuth?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("button",{key:0,onClick:e[0]||(e[0]=(...t)=>a.ipfsAuth&&a.ipfsAuth(...t))},"ipfs auth"))],64)}var H=n(2273);const F=["value"],Y=(0,s._)("br",null,null,-1);function T(t,e,n,o,r,c){return(0,s.wg)(),(0,s.iD)("div",null,[(0,s.Uk)(" Account: "),r.isReady?((0,s.wg)(),(0,s.iD)(s.HY,{key:0},[(0,s.wy)((0,s._)("select",{"onUpdate:modelValue":e[0]||(e[0]=t=>r.account=t)},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(r.accounts,((t,e)=>((0,s.wg)(),(0,s.iD)("option",{key:e,value:t.address},(0,a.zw)(t.meta.isTesting?"dev":"")+" "+(0,a.zw)(t.meta.name)+" | "+(0,a.zw)(t.meta?.source),9,F)))),128))],512),[[i.bM,r.account]]),Y,(0,s.Uk)(" "+(0,a.zw)(r.account),1)],64)):((0,s.wg)(),(0,s.iD)("button",{key:1,onClick:e[1]||(e[1]=(...t)=>c.connect&&c.connect(...t))},"connect")),(0,s._)("p",null,(0,a.zw)(r.error),1)])}var x={data(){return{isReady:!1,account:null,accounts:[],error:""}},created(){this.connect(),this.$robonomics.accountManager.onReady((()=>{this.isReady=!0}))},watch:{async account(t){await this.$robonomics.accountManager.setSender(t)}},methods:{async connect(){this.error="";try{await this.$robonomics.accountManager.initPlugin({isDevelopment:!1}),this.accounts=this.$robonomics.accountManager.getAccounts(),this.accounts.length&&(this.account=this.accounts[0].address)}catch(t){this.error=t.message}}}};const z=(0,L.Z)(x,[["render",T]]);var S=z,q={emits:["auth"],components:{Account:S},data(){return{isAuth:!1}},created(){this.$robonomics.accountManager.onChange((()=>{this.isAuth=!1}))},watch:{isAuth(){this.$emit("auth",this.isAuth)}},methods:{async ipfsAuth(){try{const t=(await this.$robonomics.accountManager.account.signMsg((0,H.d)(this.$robonomics.accountManager.account.address))).toString();this.$ipfs.auth(this.$robonomics.accountManager.account.address,t),this.isAuth=!0}catch(t){console.log(t)}}}};const E=(0,L.Z)(q,[["render",U]]);var W=E;const B={key:0},Z=["href"],G=["disabled","onClick"];function K(t,e,n,o,i,r){return i.isLoadFiles?((0,s.wg)(),(0,s.iD)("div",B,"...")):i.files.length>0?((0,s.wg)(!0),(0,s.iD)(s.HY,{key:1},(0,s.Ko)(i.files,((e,n)=>((0,s.wg)(),(0,s.iD)("div",{key:n},[(0,s._)("a",{href:`${t.$ipfs_gateway}/ipfs/${e.path}`,target:"_blank"},(0,a.zw)(e.name),9,Z),(0,s.Uk)("Â  "),"video"===e.type||"image"===e.type?((0,s.wg)(),(0,s.iD)("button",{key:0,disabled:i.isLoadVideo,onClick:t=>r.play(e.cid,e.type)}," show ",8,G)):(0,s.kq)("",!0)])))),128)):((0,s.wg)(),(0,s.iD)("button",{key:2,onClick:e[0]||(e[0]=t=>r.ls(n.cid))},"Get files"))}var N=n(3957),J={props:["controller","cid"],emits:["play"],data(){return{seed:"",files:[],isLoadFiles:!1,isLoadVideo:!1,typeInput:"password"}},async created(){this.ls(this.cid)},computed:{isValidASeed(){return null!==this.controllerAccount(this.seed)}},methods:{async ls(t){this.isLoadFiles=!0;try{this.files=(await this.$ipfs.ls(t)).map((t=>{const e=t.name.split(".").pop();let n="none";return"png"===e?n="image":"mp4"===e&&(n="video"),{...t,type:n}}))}catch(e){console.log(e)}this.isLoadFiles=!1},async play(t,e){this.isLoadVideo=!0,this.$emit("play",{isLoad:!0,content:null});try{const n=await this.$ipfs.cat(t);this.$emit("play",{isLoad:!1,type:e,content:n})}catch(n){console.log(n),this.$emit("play",{isLoad:!1,content:null})}this.isLoadVideo=!1},controllerAccount(t){if(t)try{const e=new N.Y({ss58Format:32}),n=e.addFromUri(t,{},"ed25519");if(n.address===this.controller)return n}catch(e){console.log(e)}return null},decrypt(t){const e=this.controllerAccount(this.seed),n=e.decryptMessage(t,e.publicKey);return n},togglePassword(){this.typeInput="password"===this.typeInput?"text":"password"}}};const Q=(0,L.Z)(J,[["render",K],["__scopeId","data-v-4e0cab45"]]);var X=Q;const tt={key:0},et={id:"video",width:"600",height:"480",controls:"",muted:"muted"};function nt(t,e,n,o,a,r){return(0,s.wg)(),(0,s.iD)(s.HY,null,[n.isLoad?((0,s.wg)(),(0,s.iD)("div",tt,"...")):(0,s.kq)("",!0),(0,s.wy)((0,s._)("video",et,null,512),[[i.F8,!n.isLoad]])],64)}var ot={props:["isLoad","content"],mounted(){this.loadVideo(this.content)},watch:{content(){this.loadVideo(this.content)}},methods:{loadVideo(t){if(!t)return;const e=document.getElementById("video"),n=new Blob(t,{type:"video/mp4"});e.src=URL.createObjectURL(n),e.load()}}};const it=(0,L.Z)(ot,[["render",nt]]);var st=it,at={name:"App",components:{IpfsAuth:W,IpfsFiles:X,FindVideoForm:j,VideoContent:st,ImageContent:R},data(){return{isReady:!1,videoCid:null,typeContent:null,videoController:null,videoIsLoad:!1,videoContent:null,ipfsAuth:!1}},async created(){this.$robonomicsReady((async()=>{this.isReady=!0}))},methods:{handlerFindVideo({controller:t=null,cid:e=null}={}){this.videoController=t,this.videoCid=e},handlerAuth(t){this.ipfsAuth=t},handlerPlay({isLoad:t,type:e,content:n}){this.videoIsLoad=t,this.typeContent=e,this.videoContent=n}}};const rt=(0,L.Z)(at,[["render",f]]);var ct=rt,lt={GATEWAY:"https://crustipfs.xyz"},dt=n(4091);class ut{constructor(t){this.endpoint=t,this.authHeader=null}auth(t,e){const n=`sub-${t}:${e}`;this.authHeader=Buffer.from(n).toString("base64")}authClear(){this.authHeader=null}async ls(t){const e=(0,dt.Ue)({url:this.endpoint,headers:{authorization:`Basic ${this.authHeader}`}}),n=[];for await(const o of e.ls(t))"file"===o.type&&n.push(o);return n}async cat(t){const e=(0,dt.Ue)({url:this.endpoint,headers:{authorization:`Basic ${this.authHeader}`}}),n=async t=>{const n=[];for await(const o of e.cat(t))n.push(o);return n};return await n(t)}}var ht={install:t=>{t.config.globalProperties.$ipfs=new ut(lt.GATEWAY)}},ft=n(2996),pt=n(7541),yt=n(6117),gt=n(142),wt=n(3102);function mt(){return new Promise((function(t,e){const n=setTimeout((()=>(clearTimeout(n),clearInterval(o),e(new Error("Not fount polkadot.extension")))),3e3),o=setInterval((()=>{if(Object.keys(window.injectedWeb3).length>0)return clearTimeout(n),clearInterval(o),t()}),100)}))}class vt extends k.Uk{async initPlugin(t={}){await mt();const e=await(0,pt.$y)("robonomics");if(0===e.length)throw new Error("Allow the browser extension to interact with dapp and try again.");const n=await(0,pt.vK)(),o=n.map((({address:t,meta:e})=>({address:t,meta:e})));await(0,wt.I)(),this.keyring.loadAll({...t},o),this.setReady(!0)}async afterSetSender(){if(this.api&&this.account)if(this.account.meta.isInjected&&this.account.meta.source){const t=await(0,pt.R0)(this.account.meta.source);this.api.setSigner(t.signer),this.account.signMsg=async e=>(await t.signer.signRaw({address:this.account.address,data:(0,yt.c)((0,gt.Rl)(e)),type:"bytes"})).signature}else this.account.signMsg=async t=>this.account?Promise.resolve((0,yt.c)(this.account.sign(t))):Promise.reject(new Error("not account"))}}async function bt(){try{return k.l.getInstance()}catch(t){}return await k.l.createInstance({endpoint:"wss://polkadot.rpc.robonomics.network/"})}var kt={install:async t=>{let e,n=!1;t.config.globalProperties.$robonomicsReady=t=>{n?t():e=t},t.config.globalProperties.$robonomics=await bt(),t.config.globalProperties.$robonomics.setAccountManager(new vt(ft.ZP)),n=!0,e&&e()}};window.Buffer=o.lW;const At=(0,i.ri)(ct);At.config.globalProperties.$ipfs_gateway=lt.GATEWAY,At.use(kt).use(ht).mount("#app")},5856:function(){},6601:function(){},3897:function(){},5024:function(){}},e={};function n(o){var i=e[o];if(void 0!==i)return i.exports;var s=e[o]={id:o,loaded:!1,exports:{}};return t[o].call(s.exports,s,s.exports,n),s.loaded=!0,s.exports}n.m=t,function(){n.amdO={}}(),function(){var t=[];n.O=function(e,o,i,s){if(!o){var a=1/0;for(d=0;d<t.length;d++){o=t[d][0],i=t[d][1],s=t[d][2];for(var r=!0,c=0;c<o.length;c++)(!1&s||a>=s)&&Object.keys(n.O).every((function(t){return n.O[t](o[c])}))?o.splice(c--,1):(r=!1,s<a&&(a=s));if(r){t.splice(d--,1);var l=i();void 0!==l&&(e=l)}}return e}s=s||0;for(var d=t.length;d>0&&t[d-1][2]>s;d--)t[d]=t[d-1];t[d]=[o,i,s]}}(),function(){n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,{a:e}),e}}(),function(){var t,e=Object.getPrototypeOf?function(t){return Object.getPrototypeOf(t)}:function(t){return t.__proto__};n.t=function(o,i){if(1&i&&(o=this(o)),8&i)return o;if("object"===typeof o&&o){if(4&i&&o.__esModule)return o;if(16&i&&"function"===typeof o.then)return o}var s=Object.create(null);n.r(s);var a={};t=t||[null,e({}),e([]),e(e)];for(var r=2&i&&o;"object"==typeof r&&!~t.indexOf(r);r=e(r))Object.getOwnPropertyNames(r).forEach((function(t){a[t]=function(){return o[t]}}));return a["default"]=function(){return o},n.d(s,a),s}}(),function(){n.d=function(t,e){for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){n.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t}}(),function(){var t={143:0};n.O.j=function(e){return 0===t[e]};var e=function(e,o){var i,s,a=o[0],r=o[1],c=o[2],l=0;if(a.some((function(e){return 0!==t[e]}))){for(i in r)n.o(r,i)&&(n.m[i]=r[i]);if(c)var d=c(n)}for(e&&e(o);l<a.length;l++)s=a[l],n.o(t,s)&&t[s]&&t[s][0](),t[s]=0;return n.O(d)},o=self["webpackChunkvideostream"]=self["webpackChunkvideostream"]||[];o.forEach(e.bind(null,0)),o.push=e.bind(null,o.push.bind(o))}();var o=n.O(void 0,[998],(function(){return n(9423)}));o=n.O(o)})();
//# sourceMappingURL=app.dd74e531.js.map